# KB Query Interface Architecture

## Overview

The KB Query Interface is designed as a modular system that converts natural language queries into SPARQL by leveraging the structure of an OWL ontology.

## Components

### 1. Ontology Parser
- Parses OWL/RDF ontologies using rdflib
- Extracts classes, properties, domains, and ranges
- Builds a navigable structure of the ontology

### 2. Pattern Generator
- Automatically generates query patterns from ontology structure
- Infers natural language patterns from property names
- Uses domain/range information to create valid combinations

### 3. Query Parser
- Matches natural language input against generated patterns
- Extracts entities, filters, and constraints
- Provides suggestions for incomplete queries

### 4. SPARQL Builder
- Converts parsed queries into valid SPARQL
- Handles namespaces and URI construction
- Optimizes queries for the target triple store

## Data Flow

```
Natural Language Query
        ↓
  Query Parser
        ↓ (matches against)
Generated Patterns
        ↓
  Parsed Query
        ↓
 SPARQL Builder
        ↓
  SPARQL Query
        ↓
  Triple Store
```

## Pattern Generation

Patterns are generated by analyzing:
1. Property names (camelCase decomposition)
2. Domain and range constraints
3. Parent class semantics
4. Common linguistic patterns

Example:
- Property: `kb:hasAttendee`
- Domain: `kb:Meeting`
- Range: `kb:Person`
- Generated patterns:
  - "meetings with {Person}"
  - "meetings attended by {Person}"
  - "{Person}'s meetings"
